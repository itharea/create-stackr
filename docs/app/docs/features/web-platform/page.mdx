export const metadata = {
    title: 'Web Platform',
    description: 'Next.js web application with shared authentication and dark mode support.',
};

<div className="prose">

# Web Platform

The web platform uses Next.js 14+ with App Router, providing a modern React web application
that shares authentication with your mobile app.

## Overview

<Table
    headers={["Feature", "Description"]}
    rows={[
        ["Framework", "Next.js 14+ with App Router"],
        ["Styling", "Tailwind CSS + shadcn/ui"],
        ["Authentication", "Cookie-based sessions (shared with mobile)"],
        ["Dark Mode", "next-themes with system preference"],
    ]}
/>

<Callout type="info" title="Shared Backend">
    Both web and mobile apps connect to the same Fastify backend, sharing the user database
    and authentication system.
</Callout>

## Project Structure

<CodeBlock
    code={`web/
├── src/
│   ├── app/                 # Next.js App Router
│   │   ├── (auth)/          # Auth pages (login, register, etc.)
│   │   ├── (app)/           # Protected app pages (dashboard, settings)
│   │   ├── auth/            # OAuth callback routes
│   │   ├── globals.css      # Global styles with dark mode
│   │   └── layout.tsx       # Root layout with providers
│   ├── components/
│   │   ├── ui/              # shadcn/ui components
│   │   ├── auth/            # Auth forms and buttons
│   │   ├── settings/        # Settings components
│   │   └── providers/       # Context providers
│   ├── lib/
│   │   ├── auth/            # Auth utilities and actions
│   │   └── utils.ts         # Utility functions
│   └── store/               # Zustand stores
├── public/                  # Static assets
├── next.config.ts           # Next.js configuration
└── package.json`}
    language="text"
/>

## Environment Variables

Create a `.env` file in the `web/` directory:

<CodeBlock
    code={`# Public URL of the web app (used for OAuth callbacks)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Backend API URL (server-side only, used by server actions)
BACKEND_URL=http://localhost:8080`}
    language="bash"
    filename="web/.env"
/>

## Running the Web App

<CodeBlock
    code={`cd web
bun install
bun run dev`}
    language="bash"
/>

The app runs on `http://localhost:3000` by default.

## Authentication on Web

The web platform uses **cookie-based sessions** (unlike mobile which uses token storage):

<Table
    headers={["Feature", "Mobile", "Web"]}
    rows={[
        ["Session Storage", "AsyncStorage + Secure Store", "HTTP-only Cookies"],
        ["Token Refresh", "Manual refresh", "Automatic via cookies"],
        ["OAuth Flow", "Deep links + native SDKs", "Browser redirects"],
        ["CSRF Protection", "Not needed", "Built into Better Auth"],
    ]}
/>

<Callout type="info" title="Why Cookies?">
    Cookie-based sessions are more secure for web applications - they're HTTP-only
    (no JavaScript access), automatically included in requests, and protected against XSS attacks.
</Callout>

## OAuth Configuration

For OAuth to work on web, ensure your OAuth providers have the correct redirect URIs pointing
to the **backend** (Better Auth handles the OAuth callback):

### Google Cloud Console

<CodeBlock
    code={`# Development
http://localhost:8080/api/auth/callback/google

# Production
https://api.yourdomain.com/api/auth/callback/google`}
    language="text"
/>

### Apple Developer Console

<Callout type="warning" title="HTTPS Required">
    Apple Sign In requires HTTPS for redirect URIs. It will not work with `http://localhost`
    in development. You must either use a tunneling service (ngrok, Cloudflare Tunnel),
    test in production/staging, or use the mobile app for Apple Sign In testing.
</Callout>

<CodeBlock
    code={`# Production only - HTTPS required
https://api.yourdomain.com/api/auth/callback/apple`}
    language="text"
/>

### GitHub OAuth App

<CodeBlock
    code={`# Development
http://localhost:8080/api/auth/callback/github

# Production
https://api.yourdomain.com/api/auth/callback/github`}
    language="text"
/>

## CORS Configuration

The backend must allow web origins. In `backend/.env`:

<CodeBlock
    code={`# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com`}
    language="bash"
    filename="backend/.env"
/>

## Dark Mode

The web app includes full dark mode support:

- Uses `next-themes` for theme management
- Theme persists in localStorage
- Respects system preference by default
- Toggle via the `ThemeToggle` component

## Deploying Web

See [Deployment](/docs/deployment#web-app) for detailed deployment instructions for
Vercel, Netlify, Docker, and Node.js hosting.

</div>
